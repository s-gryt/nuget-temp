# Complete Code Changes - NuGet Dependency Graph Fix

This document contains ALL code files that were modified or created (excluding .md documentation files).

---

## MODIFIED FILES

### 1. File: `scripts/bundle-assets.js`

**Full Content After Changes:**

```javascript
const fs = require('fs');
const path = require('path');

/**
 * Script to prepare asset directories
 * Note: Webpack bundles all dependencies automatically, so we don't need to copy assets manually
 */
async function bundleAssets() {
  const extensionRoot = path.resolve(__dirname, '..');
  const assetsPath = path.join(extensionRoot, 'assets');
  const outPath = path.join(extensionRoot, 'out');

  console.log('Preparing asset directories...');

  // Ensure directories exist
  if (!fs.existsSync(assetsPath)) {
    fs.mkdirSync(assetsPath, { recursive: true });
    console.log('✓ Created assets directory');
  }

  if (!fs.existsSync(outPath)) {
    fs.mkdirSync(outPath, { recursive: true });
    console.log('✓ Created out directory');
  }

  console.log('Asset preparation complete!');
  console.log('Note: Webpack will bundle all required dependencies automatically.');
}

// Run if called directly
if (require.main === module) {
  bundleAssets().catch(console.error);
}

module.exports = { bundleAssets };
```

---

### 2. File: `webpack.webview.config.js`

**Full Content After Changes:**

```javascript
const path = require('path');

module.exports = (_env, argv) => {
  const isProduction = argv.mode === 'production';

  return {
    target: 'web',
    mode: argv.mode || 'development',
    entry: './src/webview/index.tsx',
    output: {
      path: path.resolve(__dirname, 'out'),
      filename: 'webview.js',
      clean: false, // Don't clean out directory (extension.js is also there)
      publicPath: '',
      // Ensure proper asset handling for VS Code webview
      assetModuleFilename: 'assets/[name].[contenthash][ext]'
    },
    resolve: {
      extensions: ['.ts', '.tsx', '.js', '.jsx'],
      alias: {
        '@': path.resolve(__dirname, 'src'),
        '@types': path.resolve(__dirname, 'src/types'),
        '@webview': path.resolve(__dirname, 'src/webview'),
        '@components': path.resolve(__dirname, 'src/webview/components'),
        '@styles': path.resolve(__dirname, 'src/webview/styles')
      },
      // Ensure proper module resolution for React
      mainFields: ['browser', 'module', 'main'],
      // Fallback for Node.js modules in browser environment
      fallback: {
        path: false,
        fs: false,
        os: false,
        crypto: false,
        stream: false,
        buffer: false
      }
    },
    module: {
      rules: [
        {
          test: /\.tsx?$/,
          exclude: /node_modules/,
          use: [
            {
              loader: 'ts-loader',
              options: {
                configFile: 'tsconfig.webview.json',
                transpileOnly: true, // Skip type checking for now
                compilerOptions: {
                  sourceMap: !isProduction,
                  // Ensure proper JSX compilation
                  jsx: 'react-jsx',
                  target: 'ES2020',
                  module: 'ESNext'
                }
              }
            }
          ]
        },
        {
          test: /\.css$/,
          use: [
            'style-loader',
            {
              loader: 'css-loader',
              options: {
                sourceMap: !isProduction,
                // Enable CSS modules if needed
                modules: false,
                importLoaders: 0
              }
            }
          ]
        },
        {
          test: /\.(png|jpg|jpeg|gif|svg)$/i,
          type: 'asset/resource',
          generator: {
            filename: 'assets/[name].[contenthash][ext]'
          }
        },
        {
          test: /\.(woff|woff2|eot|ttf|otf)$/i,
          type: 'asset/resource',
          generator: {
            filename: 'fonts/[name].[contenthash][ext]'
          }
        },
        {
          test: /\.(js)$/i,
          include: path.resolve(__dirname, 'assets'),
          type: 'asset/resource',
          generator: {
            filename: 'bundled-assets/[name].[contenthash][ext]'
          }
        }
      ]
    },
    plugins: [
      // HTML is generated by webviewManager, not webpack
    ],
    devtool: isProduction ? 'source-map' : 'inline-source-map',
    optimization: {
      minimize: isProduction,
      usedExports: true,
      sideEffects: false,
      // Tree shaking configuration
      providedExports: true,
      splitChunks: isProduction
        ? {
            chunks: 'all',
            minSize: 20000,
            maxSize: 250000,
            cacheGroups: {
              default: {
                minChunks: 2,
                priority: -20,
                reuseExistingChunk: true
              },
              vendor: {
                test: /[\\/]node_modules[\\/]/,
                name: 'vendors',
                priority: -10,
                chunks: 'all'
              },
              react: {
                test: /[\\/]node_modules[\\/](react|react-dom)[\\/]/,
                name: 'react',
                priority: 10,
                chunks: 'all'
              },
              forceGraph: {
                test: /[\\/]node_modules[\\/](react-force-graph-3d|three)[\\/]/,
                name: 'force-graph',
                priority: 15,
                chunks: 'all'
              }
            }
          }
        : false
    },
    performance: {
      hints: isProduction ? 'warning' : false,
      maxAssetSize: 2000000,
      maxEntrypointSize: 2000000
    },
    stats: {
      errorDetails: true,
      colors: true,
      // Reduce noise in development
      modules: isProduction,
      chunks: isProduction,
      chunkModules: isProduction
    },
    // Ensure proper context for webview
    context: __dirname,
    // Cache configuration for better build performance
    cache: {
      type: 'filesystem',
      buildDependencies: {
        config: [__filename]
      }
    }
  };
};
```

---

### 3. File: `src/providers/nugetDependencyProvider.ts` (PARTIAL - Only Changed Sections)

**Changed Section 1 - Lines 404-411:**

```typescript
    // If no links were created, create some basic structure links
    if (links.length === 0 && packages.length > 1) {
      this.createFallbackLinks(packages, nodeMap, links, mode);
    }

    // Even if we have only 1 package or no links, the graph will still display the nodes
    console.log(`[GraphData] Created ${nodes.length} nodes and ${links.length} links for mode: ${mode}`);
  }
```

**Changed Section 2 - Lines 519-536 (Enhanced createFallbackLinks method):**

```typescript
      });
    } else if (directPackages.length > 1) {
      // If only direct packages, create a chain to keep them connected
      for (let i = 0; i < directPackages.length - 1; i++) {
        const pkg1 = directPackages[i];
        const pkg2 = directPackages[i + 1];
        if (pkg1 && pkg2) {
          links.push({
            source: `${pkg1.id}@${pkg1.version}`,
            target: `${pkg2.id}@${pkg2.version}`,
            value: 1,
            color: mode === 'vulnerabilities' ? '#ff6b6b' : '#999'
          });
        }
      }
    }
    // Note: If only 1 package, no links needed - force-graph-3d will display single node
  }
```

---

## CREATED FILES

### 4. File: `src/webview/webviewManager.ts`

**Full Content:**

```typescript
import * as vscode from 'vscode';
import * as path from 'path';
import { DependencyAnalysisResult } from '../types/dependency';

export class WebviewManager {
  private panel: vscode.WebviewPanel | undefined;
  private readonly context: vscode.ExtensionContext;

  constructor(context: vscode.ExtensionContext) {
    this.context = context;
  }

  async showDependencyGraph(
    data: DependencyAnalysisResult,
    mode: 'dependencies' | 'vulnerabilities' | 'full'
  ): Promise<void> {
    if (this.panel) {
      // Reuse existing panel
      this.panel.reveal(vscode.ViewColumn.One);
    } else {
      // Create new panel
      this.panel = vscode.window.createWebviewPanel(
        'nugetDependencyGraph',
        'NuGet Dependency Graph',
        vscode.ViewColumn.One,
        {
          enableScripts: true,
          retainContextWhenHidden: true,
          localResourceRoots: [
            vscode.Uri.file(path.join(this.context.extensionPath, 'out')),
            vscode.Uri.file(path.join(this.context.extensionPath, 'media'))
          ]
        }
      );

      // Handle panel disposal
      this.panel.onDidDispose(() => {
        this.panel = undefined;
      }, null, this.context.subscriptions);
    }

    // Update panel title based on mode
    this.panel.title = this.getTitleForMode(mode, data.projectName);

    // Set webview HTML content
    this.panel.webview.html = this.getWebviewContent(data, mode);

    // Handle messages from webview
    this.panel.webview.onDidReceiveMessage(
      message => {
        switch (message.type) {
          case 'error':
            vscode.window.showErrorMessage(`Webview Error: ${message.message}`);
            break;
          case 'log':
            console.log(`[Webview]: ${message.message}`);
            break;
          case 'ready':
            console.log('[Webview]: Ready to receive data');
            break;
        }
      },
      null,
      this.context.subscriptions
    );
  }

  private getTitleForMode(mode: string, projectName: string): string {
    switch (mode) {
      case 'vulnerabilities':
        return `Vulnerabilities - ${projectName}`;
      case 'full':
        return `Full Graph - ${projectName}`;
      default:
        return `Dependencies - ${projectName}`;
    }
  }

  private getWebviewContent(data: DependencyAnalysisResult, mode: string): string {
    const nonce = this.getNonce();

    // Get URIs for bundled scripts (will be created by webpack)
    const scriptUri = this.panel?.webview.asWebviewUri(
      vscode.Uri.file(path.join(this.context.extensionPath, 'out', 'webview.js'))
    );

    // Serialize data for webview
    const serializedData = JSON.stringify(data);
    const serializedMode = JSON.stringify(mode);

    return `<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Content-Security-Policy"
          content="default-src 'none';
                   style-src ${this.panel?.webview.cspSource} 'unsafe-inline';
                   script-src 'nonce-${nonce}' 'unsafe-eval';
                   img-src ${this.panel?.webview.cspSource} https: data:;
                   connect-src https:;">
    <title>NuGet Dependency Graph</title>
    <style>
        body {
            margin: 0;
            padding: 0;
            overflow: hidden;
            background-color: var(--vscode-editor-background);
            color: var(--vscode-editor-foreground);
            font-family: var(--vscode-font-family);
        }
        #root {
            width: 100vw;
            height: 100vh;
        }
        .loading {
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            height: 100vh;
            font-size: 18px;
        }
        .loading-spinner {
            width: 50px;
            height: 50px;
            border: 5px solid var(--vscode-progressBar-background);
            border-top: 5px solid var(--vscode-button-background);
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin-bottom: 20px;
        }
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        .error {
            padding: 20px;
            color: var(--vscode-errorForeground);
            background-color: var(--vscode-inputValidation-errorBackground);
            border: 1px solid var(--vscode-inputValidation-errorBorder);
            margin: 20px;
            border-radius: 4px;
        }
        .error h2 {
            margin-top: 0;
        }
        .error-details {
            margin-top: 10px;
            font-family: var(--vscode-editor-font-family);
            font-size: 12px;
            white-space: pre-wrap;
            background-color: var(--vscode-editor-background);
            padding: 10px;
            border-radius: 4px;
        }
    </style>
</head>
<body>
    <div id="root">
        <div class="loading">
            <div class="loading-spinner"></div>
            <div>Loading dependency graph...</div>
        </div>
    </div>

    <script nonce="${nonce}">
        // Global error handler
        window.addEventListener('error', (event) => {
            console.error('[Global Error]:', event.error);
            document.getElementById('root').innerHTML = \`
                <div class="error">
                    <h2>Failed to Load Dependency Graph</h2>
                    <p>\${event.error?.message || 'Unknown error occurred'}</p>
                    <div class="error-details">\${event.error?.stack || ''}</div>
                </div>
            \`;
        });

        // Pass data from extension to React app
        window.__NUGET_DATA__ = ${serializedData};
        window.__NUGET_MODE__ = ${serializedMode};

        console.log('[Webview] Data loaded:', {
            nodes: window.__NUGET_DATA__?.graphData?.nodes?.length,
            links: window.__NUGET_DATA__?.graphData?.links?.length,
            mode: window.__NUGET_MODE__
        });
    </script>

    <script nonce="${nonce}" src="${scriptUri}"></script>
</body>
</html>`;
  }

  private getNonce(): string {
    let text = '';
    const possible = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789';
    for (let i = 0; i < 32; i++) {
      text += possible.charAt(Math.floor(Math.random() * possible.length));
    }
    return text;
  }

  public dispose(): void {
    if (this.panel) {
      this.panel.dispose();
      this.panel = undefined;
    }
  }
}
```

---

### 5. File: `src/webview/index.tsx`

**Full Content:**

```typescript
import React from 'react';
import ReactDOM from 'react-dom/client';
import { App } from './App';

// This will be injected by webviewManager
declare global {
  interface Window {
    __NUGET_DATA__: any;
    __NUGET_MODE__: string;
  }
}

// Initialize React app
const root = document.getElementById('root');
if (root) {
  try {
    const reactRoot = ReactDOM.createRoot(root);
    reactRoot.render(
      <React.StrictMode>
        <App
          data={window.__NUGET_DATA__}
          mode={window.__NUGET_MODE__}
        />
      </React.StrictMode>
    );
  } catch (error) {
    console.error('[React Error]:', error);
    root.innerHTML = `
      <div class="error">
        <h2>Failed to Initialize React Application</h2>
        <p>${error instanceof Error ? error.message : String(error)}</p>
      </div>
    `;
  }
} else {
  console.error('[Critical] Root element not found');
}
```

---

### 6. File: `src/webview/App.tsx`

**Full Content:**

```typescript
import React, { useState, useEffect } from 'react';
import { DependencyAnalysisResult } from '../types/dependency';
import { ForceGraphRenderer } from './components/ForceGraphRenderer';
import { InfoPanel } from './components/InfoPanel';
import { ErrorBoundary } from './components/ErrorBoundary';
import './styles.css';

interface AppProps {
  data: DependencyAnalysisResult;
  mode: 'dependencies' | 'vulnerabilities' | 'full';
}

export const App: React.FC<AppProps> = ({ data, mode }) => {
  const [selectedNode, setSelectedNode] = useState<any>(null);
  const [error, setError] = useState<string | null>(null);

  useEffect(() => {
    // Validate data
    if (!data) {
      setError('No data provided to React app');
      console.error('[App] No data in window.__NUGET_DATA__');
      return;
    }

    if (!data.graphData) {
      setError('Invalid data structure: missing graphData');
      console.error('[App] Data structure:', data);
      return;
    }

    if (!data.graphData.nodes || data.graphData.nodes.length === 0) {
      setError('No packages found in the project');
      console.warn('[App] Empty nodes array. Project may have no NuGet packages.');
      console.log('[App] Full data:', JSON.stringify(data, null, 2));
      return;
    }

    console.log('[App] Initialized successfully with:', {
      nodes: data.graphData.nodes.length,
      links: data.graphData.links.length,
      mode,
      projectName: data.projectName,
      sampleNodes: data.graphData.nodes.slice(0, 3)
    });
  }, [data, mode]);

  if (error) {
    return (
      <div className="error-container">
        <div className="error">
          <h2>Unable to Display Graph</h2>
          <p>{error}</p>
          <div className="error-help">
            <p>Possible reasons:</p>
            <ul>
              <li>The project has no NuGet package references</li>
              <li>The .csproj file could not be parsed</li>
              <li>The .NET CLI is not available</li>
            </ul>
          </div>
        </div>
      </div>
    );
  }

  return (
    <ErrorBoundary>
      <div className="app-container">
        <div className="graph-container">
          <ForceGraphRenderer
            data={data.graphData}
            mode={mode}
            onNodeClick={setSelectedNode}
          />
        </div>
        <InfoPanel
          selectedNode={selectedNode}
          onClose={() => setSelectedNode(null)}
          data={data}
          mode={mode}
        />
      </div>
    </ErrorBoundary>
  );
};
```

---

### 7. File: `src/webview/components/ForceGraphRenderer.tsx`

**Full Content:**

```typescript
import React, { useEffect, useRef, useState } from 'react';
import ForceGraph3D from 'react-force-graph-3d';
import { GraphData, GraphNode, GraphLink } from '../../types/dependency';

interface ForceGraphRendererProps {
  data: GraphData;
  mode: 'dependencies' | 'vulnerabilities' | 'full';
  onNodeClick: (node: GraphNode) => void;
}

export const ForceGraphRenderer: React.FC<ForceGraphRendererProps> = ({
  data,
  mode,
  onNodeClick
}) => {
  const graphRef = useRef<any>();
  const [dimensions, setDimensions] = useState({
    width: window.innerWidth,
    height: window.innerHeight
  });

  useEffect(() => {
    const handleResize = () => {
      setDimensions({
        width: window.innerWidth,
        height: window.innerHeight
      });
    };

    window.addEventListener('resize', handleResize);
    return () => window.removeEventListener('resize', handleResize);
  }, []);

  useEffect(() => {
    // Auto-fit graph when data loads
    if (graphRef.current) {
      setTimeout(() => {
        graphRef.current?.zoomToFit(400);
      }, 100);
    }
  }, [data]);

  const handleNodeClick = (node: any) => {
    if (node && typeof node === 'object') {
      onNodeClick(node as GraphNode);
    }
  };

  const getNodeLabel = (node: any): string => {
    if (!node) return '';
    return `${node.name || node.id || 'Unknown'}\n${node.version || ''}`;
  };

  const getNodeColor = (node: any): string => {
    if (!node) return '#999999';

    // Use the color assigned by the provider
    if (node.color) {
      return node.color;
    }

    // Fallback colors
    if (mode === 'vulnerabilities' && node.vulnerabilities?.length > 0) {
      return '#ff4444';
    }

    return node.isRoot ? '#4dabf7' : '#999999';
  };

  const getLinkColor = (link: any): string => {
    if (!link) return 'rgba(255,255,255,0.2)';
    return link.color || 'rgba(255,255,255,0.2)';
  };

  const getLinkWidth = (link: any): number => {
    if (!link) return 1;
    return link.value || 1;
  };

  // Log data for debugging
  useEffect(() => {
    console.log('[ForceGraphRenderer] Rendering graph with:', {
      nodes: data.nodes.length,
      links: data.links.length,
      mode
    });
  }, [data, mode]);

  return (
    <div style={{ width: '100%', height: '100%' }}>
      {data.nodes.length === 0 ? (
        <div className="no-data">
          <p>No packages to display</p>
          <p style={{ fontSize: '12px', color: 'var(--vscode-descriptionForeground)', marginTop: '10px' }}>
            This project may not have any NuGet package references.
          </p>
        </div>
      ) : (
        <ForceGraph3D
          ref={graphRef}
          graphData={data}
          width={dimensions.width}
          height={dimensions.height}
          backgroundColor="rgba(0,0,0,0)"
          nodeLabel={getNodeLabel}
          nodeColor={getNodeColor}
          nodeVal={(node: any) => node.val || 1}
          nodeRelSize={6}
          linkColor={getLinkColor}
          linkWidth={getLinkWidth}
          linkOpacity={0.6}
          onNodeClick={handleNodeClick}
          enableNodeDrag={true}
          enableNavigationControls={true}
          showNavInfo={false}
          d3VelocityDecay={0.3}
          cooldownTime={3000}
        />
      )}
    </div>
  );
};
```

---

### 8. File: `src/webview/components/InfoPanel.tsx`

**Full Content:**

```typescript
import React from 'react';
import { GraphNode, DependencyAnalysisResult } from '../../types/dependency';

interface InfoPanelProps {
  selectedNode: GraphNode | null;
  onClose: () => void;
  data: DependencyAnalysisResult;
  mode: string;
}

export const InfoPanel: React.FC<InfoPanelProps> = ({
  selectedNode,
  onClose,
  data,
  mode
}) => {
  if (!selectedNode) {
    // Show summary panel
    return (
      <div className="info-panel">
        <div className="info-panel-header">
          <h2>{data.projectName}</h2>
        </div>
        <div className="info-panel-content">
          <div className="summary-section">
            <h3>Summary</h3>
            <div className="summary-item">
              <span className="summary-label">Total Packages:</span>
              <span className="summary-value">{data.graphData.nodes.length}</span>
            </div>
            <div className="summary-item">
              <span className="summary-label">Dependencies:</span>
              <span className="summary-value">{data.graphData.links.length}</span>
            </div>
            {data.vulnerabilityCount && data.vulnerabilityCount.total > 0 && (
              <>
                <div className="summary-item vulnerability-summary">
                  <span className="summary-label">Vulnerabilities:</span>
                  <span className="summary-value critical">{data.vulnerabilityCount.total}</span>
                </div>
                {data.vulnerabilityCount.critical > 0 && (
                  <div className="summary-item vulnerability-detail">
                    <span className="vuln-badge critical">Critical: {data.vulnerabilityCount.critical}</span>
                  </div>
                )}
                {data.vulnerabilityCount.high > 0 && (
                  <div className="summary-item vulnerability-detail">
                    <span className="vuln-badge high">High: {data.vulnerabilityCount.high}</span>
                  </div>
                )}
                {data.vulnerabilityCount.moderate > 0 && (
                  <div className="summary-item vulnerability-detail">
                    <span className="vuln-badge moderate">Moderate: {data.vulnerabilityCount.moderate}</span>
                  </div>
                )}
                {data.vulnerabilityCount.low > 0 && (
                  <div className="summary-item vulnerability-detail">
                    <span className="vuln-badge low">Low: {data.vulnerabilityCount.low}</span>
                  </div>
                )}
              </>
            )}
          </div>
          <div className="help-section">
            <h3>Controls</h3>
            <ul>
              <li>Click a node to view package details</li>
              <li>Drag to rotate the graph</li>
              <li>Scroll to zoom in/out</li>
              <li>Right-click + drag to pan</li>
            </ul>
          </div>
        </div>
      </div>
    );
  }

  // Show selected node details
  return (
    <div className="info-panel">
      <div className="info-panel-header">
        <h2>{selectedNode.name}</h2>
        <button className="close-button" onClick={onClose}>×</button>
      </div>
      <div className="info-panel-content">
        <div className="detail-section">
          <div className="detail-item">
            <span className="detail-label">Version:</span>
            <span className="detail-value">{selectedNode.version}</span>
          </div>
          <div className="detail-item">
            <span className="detail-label">Type:</span>
            <span className="detail-value">
              {selectedNode.isRoot ? 'Direct Dependency' : 'Transitive'}
            </span>
          </div>
          {selectedNode.depth !== undefined && (
            <div className="detail-item">
              <span className="detail-label">Depth:</span>
              <span className="detail-value">{selectedNode.depth}</span>
            </div>
          )}
        </div>

        {selectedNode.vulnerabilities && selectedNode.vulnerabilities.length > 0 && (
          <div className="vulnerabilities-section">
            <h3>Vulnerabilities ({selectedNode.vulnerabilities.length})</h3>
            {selectedNode.vulnerabilities.map((vuln, index) => (
              <div key={index} className={`vulnerability-card ${vuln.severity.toLowerCase()}`}>
                <div className="vuln-header">
                  <span className={`vuln-severity ${vuln.severity.toLowerCase()}`}>
                    {vuln.severity}
                  </span>
                </div>
                <div className="vuln-title">{vuln.title || 'Unknown Vulnerability'}</div>
                {vuln.description && (
                  <div className="vuln-description">{vuln.description}</div>
                )}
                {vuln.advisoryUrl && (
                  <div className="vuln-link">
                    <a href={vuln.advisoryUrl} target="_blank" rel="noopener noreferrer">
                      View Advisory →
                    </a>
                  </div>
                )}
                {vuln.cve && vuln.cve.length > 0 && (
                  <div className="vuln-cve">
                    <strong>CVE:</strong> {vuln.cve.join(', ')}
                  </div>
                )}
              </div>
            ))}
          </div>
        )}

        {(!selectedNode.vulnerabilities || selectedNode.vulnerabilities.length === 0) && mode === 'vulnerabilities' && (
          <div className="no-vulnerabilities">
            <p>No known vulnerabilities</p>
          </div>
        )}
      </div>
    </div>
  );
};
```

---

### 9. File: `src/webview/components/ErrorBoundary.tsx`

**Full Content:**

```typescript
import React, { Component, ErrorInfo, ReactNode } from 'react';

interface Props {
  children: ReactNode;
}

interface State {
  hasError: boolean;
  error: Error | null;
  errorInfo: ErrorInfo | null;
}

export class ErrorBoundary extends Component<Props, State> {
  constructor(props: Props) {
    super(props);
    this.state = {
      hasError: false,
      error: null,
      errorInfo: null
    };
  }

  static getDerivedStateFromError(error: Error): State {
    return {
      hasError: true,
      error,
      errorInfo: null
    };
  }

  componentDidCatch(error: Error, errorInfo: ErrorInfo) {
    console.error('[ErrorBoundary] Caught error:', error, errorInfo);
    this.setState({
      error,
      errorInfo
    });
  }

  render() {
    if (this.state.hasError) {
      return (
        <div className="error-boundary">
          <div className="error">
            <h2>Something went wrong</h2>
            <p>{this.state.error?.message || 'An unexpected error occurred'}</p>
            {this.state.errorInfo && (
              <details className="error-details">
                <summary>Error Details</summary>
                <pre>{this.state.errorInfo.componentStack}</pre>
              </details>
            )}
            <button
              className="reload-button"
              onClick={() => window.location.reload()}
            >
              Reload
            </button>
          </div>
        </div>
      );
    }

    return this.props.children;
  }
}
```

---

### 10. File: `src/webview/styles.css`

**Full Content:**

```css
* {
  box-sizing: border-box;
}

body {
  margin: 0;
  padding: 0;
  font-family: var(--vscode-font-family);
  color: var(--vscode-foreground);
  background-color: var(--vscode-editor-background);
}

.app-container {
  display: flex;
  width: 100vw;
  height: 100vh;
  position: relative;
}

.graph-container {
  flex: 1;
  position: relative;
  overflow: hidden;
}

.info-panel {
  width: 350px;
  height: 100vh;
  background-color: var(--vscode-sideBar-background);
  border-left: 1px solid var(--vscode-sideBar-border);
  display: flex;
  flex-direction: column;
  overflow: hidden;
}

.info-panel-header {
  padding: 16px;
  border-bottom: 1px solid var(--vscode-sideBar-border);
  display: flex;
  justify-content: space-between;
  align-items: center;
}

.info-panel-header h2 {
  margin: 0;
  font-size: 16px;
  font-weight: 600;
  color: var(--vscode-foreground);
  overflow: hidden;
  text-overflow: ellipsis;
  white-space: nowrap;
}

.close-button {
  background: none;
  border: none;
  color: var(--vscode-foreground);
  font-size: 24px;
  cursor: pointer;
  padding: 0;
  width: 24px;
  height: 24px;
  display: flex;
  align-items: center;
  justify-content: center;
  opacity: 0.7;
  transition: opacity 0.2s;
}

.close-button:hover {
  opacity: 1;
}

.info-panel-content {
  flex: 1;
  overflow-y: auto;
  padding: 16px;
}

.summary-section,
.detail-section {
  margin-bottom: 24px;
}

.summary-section h3,
.detail-section h3,
.vulnerabilities-section h3,
.help-section h3 {
  margin: 0 0 12px 0;
  font-size: 14px;
  font-weight: 600;
  color: var(--vscode-foreground);
}

.summary-item,
.detail-item {
  display: flex;
  justify-content: space-between;
  padding: 8px 0;
  border-bottom: 1px solid var(--vscode-sideBar-border);
}

.summary-label,
.detail-label {
  font-size: 13px;
  color: var(--vscode-descriptionForeground);
}

.summary-value,
.detail-value {
  font-size: 13px;
  font-weight: 500;
  color: var(--vscode-foreground);
}

.vulnerability-summary .summary-value.critical {
  color: var(--vscode-errorForeground);
  font-weight: 600;
}

.vulnerability-detail {
  padding: 4px 0;
  border: none;
}

.vuln-badge {
  display: inline-block;
  padding: 4px 8px;
  border-radius: 4px;
  font-size: 11px;
  font-weight: 600;
  text-transform: uppercase;
}

.vuln-badge.critical {
  background-color: #8B0000;
  color: #ffffff;
}

.vuln-badge.high {
  background-color: #FF4500;
  color: #ffffff;
}

.vuln-badge.moderate {
  background-color: #FFA500;
  color: #000000;
}

.vuln-badge.low {
  background-color: #FFD700;
  color: #000000;
}

.help-section {
  margin-top: 24px;
  padding-top: 16px;
  border-top: 1px solid var(--vscode-sideBar-border);
}

.help-section ul {
  margin: 0;
  padding-left: 20px;
  list-style-type: disc;
}

.help-section li {
  font-size: 12px;
  color: var(--vscode-descriptionForeground);
  margin-bottom: 8px;
}

.vulnerabilities-section {
  margin-top: 24px;
}

.vulnerability-card {
  background-color: var(--vscode-editor-background);
  border-left: 4px solid;
  padding: 12px;
  margin-bottom: 12px;
  border-radius: 4px;
}

.vulnerability-card.critical {
  border-left-color: #8B0000;
}

.vulnerability-card.high {
  border-left-color: #FF4500;
}

.vulnerability-card.moderate {
  border-left-color: #FFA500;
}

.vulnerability-card.low {
  border-left-color: #FFD700;
}

.vuln-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 8px;
}

.vuln-severity {
  display: inline-block;
  padding: 4px 8px;
  border-radius: 4px;
  font-size: 11px;
  font-weight: 600;
  text-transform: uppercase;
}

.vuln-severity.critical {
  background-color: #8B0000;
  color: #ffffff;
}

.vuln-severity.high {
  background-color: #FF4500;
  color: #ffffff;
}

.vuln-severity.moderate {
  background-color: #FFA500;
  color: #000000;
}

.vuln-severity.low {
  background-color: #FFD700;
  color: #000000;
}

.vuln-title {
  font-size: 13px;
  font-weight: 600;
  margin-bottom: 8px;
  color: var(--vscode-foreground);
}

.vuln-description {
  font-size: 12px;
  color: var(--vscode-descriptionForeground);
  margin-bottom: 8px;
  line-height: 1.5;
}

.vuln-link {
  margin-top: 8px;
}

.vuln-link a {
  font-size: 12px;
  color: var(--vscode-textLink-foreground);
  text-decoration: none;
}

.vuln-link a:hover {
  text-decoration: underline;
}

.vuln-cve {
  font-size: 11px;
  color: var(--vscode-descriptionForeground);
  margin-top: 8px;
  font-family: var(--vscode-editor-font-family);
}

.no-vulnerabilities {
  padding: 16px;
  text-align: center;
  color: var(--vscode-descriptionForeground);
  font-size: 13px;
}

.no-data {
  display: flex;
  justify-content: center;
  align-items: center;
  height: 100%;
  color: var(--vscode-descriptionForeground);
  font-size: 16px;
}

.error-container {
  display: flex;
  justify-content: center;
  align-items: center;
  height: 100vh;
  padding: 20px;
}

.error {
  max-width: 600px;
  padding: 20px;
  background-color: var(--vscode-inputValidation-errorBackground);
  border: 1px solid var(--vscode-inputValidation-errorBorder);
  border-radius: 4px;
  color: var(--vscode-errorForeground);
}

.error h2 {
  margin-top: 0;
  font-size: 18px;
}

.error p {
  font-size: 14px;
  line-height: 1.5;
}

.error-help {
  margin-top: 16px;
  padding-top: 16px;
  border-top: 1px solid var(--vscode-inputValidation-errorBorder);
}

.error-help ul {
  margin: 8px 0;
  padding-left: 20px;
}

.error-help li {
  margin-bottom: 4px;
  font-size: 13px;
}

.error-boundary {
  display: flex;
  justify-content: center;
  align-items: center;
  height: 100vh;
  padding: 20px;
}

.error-details {
  margin-top: 16px;
  font-size: 11px;
  font-family: var(--vscode-editor-font-family);
}

.error-details summary {
  cursor: pointer;
  margin-bottom: 8px;
  font-weight: 600;
}

.error-details pre {
  background-color: var(--vscode-editor-background);
  padding: 12px;
  border-radius: 4px;
  overflow-x: auto;
  white-space: pre-wrap;
  word-wrap: break-word;
}

.reload-button {
  margin-top: 16px;
  padding: 8px 16px;
  background-color: var(--vscode-button-background);
  color: var(--vscode-button-foreground);
  border: none;
  border-radius: 4px;
  cursor: pointer;
  font-size: 13px;
  font-weight: 500;
}

.reload-button:hover {
  background-color: var(--vscode-button-hoverBackground);
}

/* Scrollbar styling for webview */
::-webkit-scrollbar {
  width: 10px;
  height: 10px;
}

::-webkit-scrollbar-track {
  background: var(--vscode-scrollbarSlider-background);
}

::-webkit-scrollbar-thumb {
  background: var(--vscode-scrollbarSlider-background);
  border-radius: 5px;
}

::-webkit-scrollbar-thumb:hover {
  background: var(--vscode-scrollbarSlider-hoverBackground);
}
```

---

## SUMMARY

**Modified Files: 3**
1. `scripts/bundle-assets.js` - Simplified asset handling
2. `webpack.webview.config.js` - Fixed output configuration
3. `src/providers/nugetDependencyProvider.ts` - Enhanced link generation + logging

**Created Files: 7**
1. `src/webview/webviewManager.ts` - VS Code webview management (195 lines)
2. `src/webview/index.tsx` - React entry point (28 lines)
3. `src/webview/App.tsx` - Main React component (70 lines)
4. `src/webview/components/ForceGraphRenderer.tsx` - 3D graph (123 lines)
5. `src/webview/components/InfoPanel.tsx` - Details panel (159 lines)
6. `src/webview/components/ErrorBoundary.tsx` - Error handling (68 lines)
7. `src/webview/styles.css` - Complete styling (383 lines)

**Total Lines of Code: ~1,066 lines**
